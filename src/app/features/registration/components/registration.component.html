<div class="registration__container container pt-2 pb-1">
  <div class="row bottom-border justify-content-center">
    <a href="/workbench/reporting"
      ><img class="logo" src="/assets/images/adoya-client-portal.png" alt=""
    /></a>
    <div class="d-none d-print-block">
      <span [innerHTML]="printViewText"></span>
    </div>
  </div>
  <div class="row d-print-none">
    <div class="workbench__loading" *ngIf="isLoadingResults">
      <mat-spinner color="primary" strokeWidth="6.5"></mat-spinner>
    </div>
    <mat-vertical-stepper [linear]="true" #stepper class="w-100">
      <!-- step 1 invite-->
      <mat-step [stepControl]="step0Form">
        <div class="workbench__sending p-2 col-6" *ngIf="isSendingResults">
          <mat-progress-bar
            color="primary"
            mode="indeterminate"
          ></mat-progress-bar>
        </div>
        <form [formGroup]="step0Form">
          <ng-template matStepLabel
            >Invite us to be an API user
            <mat-icon class="pl-2" color="accent"
              >outgoing_mail</mat-icon
            ></ng-template
          >
          <div class="col-6 mb-2">
            In order for our system to manage and optimize your campaigns, first
            send an invite for us to connect to you account using the following
            steps:

            <ol type="1">
              <li class="mb-2 p-2 border-bottom">
                From the
                <a
                  href="https://app.searchads.apple.com/cm/app/settings/users/invite"
                  target="_blank"
                  class="adoya-link"
                  >Apple Search Ads UI</a
                >, choose Sign In Advanced and log in as an account
                administrator.
              </li>
              <li class="mb-2 p-2 border-bottom">
                From the Users menu in the top-right corner, select the account
                to invite users to.
              </li>
              <li class="mb-2 p-2 border-bottom">
                Click Invite Users to invite users to your Apple Search Ads
                organization.
              </li>
              <li class="mb-2 p-2 border-bottom">
                In the User Details section, enter the user's first name, last
                name, and <strong>info@adoya.io</strong>
              </li>
              <li class="mb-2 p-2 border-bottom">Click Send Invite.</li>
            </ol>

            When completed, enter your Apple Org Id and click 'ready to
            proceed'. In 24-48 hours, we'll email you when we're linked up and
            you're ready to continue.
          </div>

          <div class="col-6 no-gutters">
            <mat-form-field appearance="fill" color="primary" class="col-11">
              <mat-label>Apple Organization Id</mat-label>
              <input
                matInput
                placeholder="organization id"
                required
                formControlName="appleOrgId"
              />
            </mat-form-field>
            <button
              mat-icon-button
              class="float-left"
              (click)="
                handleTooltipClick($event, 'Apple Search Ads Organiztion ID')
              "
            >
              <mat-icon
                class="float-left"
                color="primary"
                matTooltip="Your Apple Search Ads Organiztion ID can be found on your Apple Search Ads Console. &#13; &#13;
                    Click for exact details on where to find this
                    information"
                >help</mat-icon
              >
            </button>
          </div>

          <button
            *ngIf="step1NextVisible()"
            (click)="handleInviteSentEvent($event)"
            [disabled]="
              inviteSent ||
              appleOrgIdControl.invalid ||
              isLoadingResults ||
              isSendingResults
            "
            mat-flat-button
            color="primary"
            class="float-left ml-2 border rounded"
          >
            <mat-icon class="text-light" aria-label="submit">done</mat-icon>
            <span class="text-light pl-1">ready to proceed</span>
          </button>
          <div *ngIf="!step1NextVisible()" class="ml-3 mb-2">
            You're ready to proceed to the next step! When ready, click next.
          </div>

          <button
            [disabled]="appleOrgIdControl.invalid"
            *ngIf="!step1NextVisible()"
            mat-flat-button
            color="primary"
            matStepperNext
            class="float-left ml-2 border rounded"
          >
            <mat-icon class="text-light" aria-label="submit">done</mat-icon>
            <span class="text-light pl-1">next</span>
          </button>
        </form>
      </mat-step>

      <!-- step 2 account-->
      <mat-step [stepControl]="step1Form">
        <form [formGroup]="step1Form">
          <ng-template matStepLabel
            >Tell us about your Apple Search Ads Account
            <mat-icon class="pl-2" color="accent">feed</mat-icon></ng-template
          >

          <!-- skeleton loader -->
          <div class="w-100 mt-2" *ngIf="isLoadingResults">
            <ngx-skeleton-loader
              count="4"
              [theme]="{
                'border-radius': '0',
                height: '50px',
                width: '100%',
                'background-color': 'WhiteSmoke',
                'margin-top': '5px'
              }"
            ></ngx-skeleton-loader>
          </div>

          <div *ngIf="!isLoadingResults" class="w-100 mt-2 d-flex flex-row">
            <div class="col-6">
              <div class="w-100 no-gutters">
                <mat-form-field
                  appearance="fill"
                  color="primary"
                  class="col-11"
                >
                  <mat-label>Client Id</mat-label>
                  <input
                    readonly="true"
                    matInput
                    placeholder="client id"
                    required
                    formControlName="clientId"
                  />
                </mat-form-field>

                <button
                  mat-icon-button
                  class="float-left"
                  (click)="handleTooltipClick($event, 'Client ID')"
                >
                  <mat-icon
                    class="float-left"
                    color="primary"
                    matTooltip="Your client ID can be found on your Apple Search Ads Console. &#13; &#13;
                        Click for exact details on where to find this
                        information"
                    >help</mat-icon
                  >
                </button>
              </div>

              <div class="w-100 no-gutters">
                <mat-form-field
                  appearance="fill"
                  color="primary"
                  class="col-11"
                >
                  <mat-label>Team Id</mat-label>
                  <input
                    readonly="true"
                    matInput
                    placeholder="team id"
                    required
                    formControlName="teamId"
                  />
                </mat-form-field>

                <button
                  mat-icon-button
                  class="float-left"
                  (click)="handleTooltipClick($event, 'Team ID')"
                >
                  <mat-icon
                    class="float-left"
                    color="primary"
                    matTooltip="Your team id can be found on your Apple Search Ads Console. &#13; &#13;
                        Click for exact details on where to find this
                        information"
                    >help</mat-icon
                  >
                </button>
              </div>

              <div class="w-100 no-gutters">
                <mat-form-field
                  appearance="fill"
                  color="primary"
                  class="col-11"
                >
                  <mat-label>Key ID</mat-label>
                  <input
                    readonly="true"
                    matInput
                    placeholder="key id"
                    required
                    formControlName="keyId"
                  />
                </mat-form-field>

                <button
                  class="float-left"
                  mat-icon-button
                  (click)="handleTooltipClick($event, 'Key ID')"
                >
                  <mat-icon
                    class="float-left"
                    color="primary"
                    matTooltip="Your key id can be found on your Apple Search Ads Console. &#13; &#13;
                        Click for exact details on where to find this
                        information"
                    >help</mat-icon
                  >
                </button>
              </div>

              <!-- <div class="w-100 no-gutters d-none">
                <mat-form-field
                  appearance="fill"
                  color="primary"
                  class="col-11"
                >
                  <mat-label>Private Key</mat-label>

                  <textarea
                    matInput
                    cdkTextareaAutosize
                    formControlName="privateKey"
                  >
                  </textarea>
                </mat-form-field>

                <button
                  mat-icon-button
                  class="float-left"
                  (click)="handleTooltipClick($event, 'Private Key')"
                >
                  <mat-icon
                    class="float-left"
                    color="primary"
                    matTooltip="Your key id can be found on your Apple Search Ads Console. &#13; &#13;
                        Click for exact details on where to find this
                        information"
                    >help</mat-icon
                  >
                </button>
              </div> -->

              <div class="w-100 no-gutters invisible">
                <mat-form-field
                  appearance="fill"
                  color="primary"
                  class="col-11"
                >
                  <mat-label>Organization Id</mat-label>
                  <input
                    matInput
                    placeholder="organization id"
                    required
                    formControlName="orgId"
                  />
                </mat-form-field>
                <button
                  mat-icon-button
                  class="float-left"
                  (click)="
                    handleTooltipClick(
                      $event,
                      'Apple Search Ads Organiztion ID'
                    )
                  "
                >
                  <mat-icon
                    class="float-left"
                    color="primary"
                    matTooltip="Your Apple Search Ads Organiztion ID can be found on your Apple Search Ads Console. &#13; &#13;
                        Click for exact details on where to find this
                        information"
                    >help</mat-icon
                  >
                </button>
              </div>
            </div>

            <div class="col-6">
              <mat-list>
                <div class="mb-2 pb-2 border-bottom w-100">
                  <mat-list-item>
                    <mat-icon color="primary" class="align-text-top mr-2"
                      >done</mat-icon
                    >

                    We gathered some details about your Apple Search Ads
                    account, this allows our system to optimize bids for you.
                  </mat-list-item>
                </div>

                <div class="mb-2 pb-2 border-bottom">
                  <mat-list-item>
                    <mat-icon color="primary" class="align-text-top mr-2"
                      >done</mat-icon
                    >

                    Nothing for you to do here! Click next to continue creating
                    your campaigns.
                  </mat-list-item>
                </div>

                <!-- <div class="pb-2 w-100">
                  <mat-list-item>
                    <mat-icon color="primary" class="align-text-top mr-2"
                      >done</mat-icon
                    >

                    Enter the 3 ids provided when you uploaded your public key
                    to the Apple Search console. From the Apple Search Ads UI,
                    choose Account Settings > API. Paste the key below into the
                    Public Key field.
                  </mat-list-item>
                </div> -->

                <!-- <div class="mb-2 pb-2 ml-5 border-bottom w-100">
                  <mat-list-item>
                    <mat-form-field
                      class="w-100 font-size-12 bg-med text-muted"
                    >
                      <textarea matInput cdkTextareaAutosize readonly="true">
-----BEGIN PUBLIC KEY-----
MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEfsYLIIQVzyQWizAguQWR9l7ZkXij
RAzgJRXGuq/Q/th1FqlsFyE7vr4xDCw53+JoJebvKBy8QbZgSWON8TohdA==
-----END PUBLIC KEY-----</textarea
                      >
                    </mat-form-field>
                  </mat-list-item>
                </div> -->

                <!-- <div class="mb-2 pb-2 border-bottom">
                  <mat-list-item>
                    <mat-icon color="primary" class="align-text-top mr-2"
                      >done</mat-icon
                    >

                    Hover and click on the help icons for exact details on where
                    to find these details in Apple Search Ads
                  </mat-list-item>
                </div>

                <div class="mb-2 pb-2 ml-4 pl-2">
                  <mat-list-item>

                    <mat-label class="font-weight-bold">
                      We can take care of this step for you, enter your Apple
                      Search Ads Org Id, then click 'request help on this step'
                      below to send us a notification.
                    </mat-label>
                  </mat-list-item>
                </div> -->
              </mat-list>

              <!-- <div class="d-flex w-100 justify-content-start ml-5">
                <button
                  (click)="handleRegHelpEvent($event)"
                  [disabled]="regHelpEventDisabled()"
                  mat-flat-button
                  color="primary"
                  class="float-right"
                >
                  <span class="text-light pl-1"
                    >request help on this step
                    <mat-icon class="text-light align-middle"
                      >help_outline</mat-icon
                    >
                  </span>
                </button>
              </div> -->
            </div>
          </div>

          <button
            mat-flat-button
            matStepperPrevious
            color="primary"
            class="float-left ml-3"
          >
            <span class="text-light pl-1">previous</span>
          </button>

          <button
            mat-flat-button
            matStepperNext
            color="primary"
            class="float-left ml-3"
            [disabled]="step1Form.invalid || isLoadingResults"
          >
            <mat-icon class="text-light" aria-label="submit">done</mat-icon>
            <span class="text-light pl-1">next</span>
          </button>
        </form>
      </mat-step>

      <!-- step 3 campaings-->
      <mat-step [stepControl]="step2Form">
        <form [formGroup]="step2Form">
          <ng-template matStepLabel
            >Create and Import your campaigns<mat-icon
              class="pl-2"
              color="accent"
              >assignment_add</mat-icon
            ></ng-template
          >

          <!-- skeleton loader -->
          <div class="w-100 mt-2" *ngIf="isLoadingResults">
            <ngx-skeleton-loader
              count="4"
              [theme]="{
                'border-radius': '0',
                height: '50px',
                width: '100%',
                'background-color': 'WhiteSmoke',
                'margin-top': '5px'
              }"
            ></ngx-skeleton-loader>
          </div>
          <!-- TODO create or import -->

          <!-- 2.1 Select app, select country-->
          <ng-container *ngIf="!isLoadingResults">
            <div
              formGroupName="substep1"
              class="w-100 mt-2"
              *ngIf="isOrdinalActive(1)"
            >
              <div class="w-100 row no-gutters">
                <!-- form -->
                <div class="col-6">
                  <!-- field and icon -->
                  <div class="w-100 no-gutters">
                    <mat-form-field
                      class="col-10 ml-1"
                      appearance="fill"
                      color="primary"
                    >
                      <mat-select formControlName="application">
                        <ng-container *ngFor="let app of apps">
                          <mat-option [value]="app.adamId">{{
                            app.appName
                          }}</mat-option>
                        </ng-container>
                      </mat-select>
                      <mat-label>&nbsp;Select Application </mat-label>
                    </mat-form-field>

                    <mat-icon
                      class="float-left pr-2"
                      color="primary"
                      matTooltip="Select the app you want to promote. &#13; &#13; If you have more than one app, you'll have a chance to create campaigns for those later."
                      >help</mat-icon
                    >
                  </div>

                  <!-- field and icon -->
                  <div class="w-100 no-gutters">
                    <mat-form-field
                      class="col-10 ml-1"
                      appearance="fill"
                      color="primary"
                    >
                      <mat-select formControlName="country">
                        <ng-container *ngFor="let country of countries">
                          <mat-option [value]="country.code">{{
                            country.name
                          }}</mat-option>
                        </ng-container>
                      </mat-select>
                      <mat-label>Select Country</mat-label>
                    </mat-form-field>

                    <mat-icon
                      class="float-left"
                      color="primary"
                      matTooltip="Select the country where you want to promote your app. &#13; &#13; If you want to target additional countries, you'll have a chance to create country-specific campaigns later"
                      >help</mat-icon
                    >
                  </div>

                  <!-- field and icon -->
                  <div class="w-100 no-gutters">
                    <mat-form-field
                      class="col-10 ml-1"
                      appearance="fill"
                      color="primary"
                    >
                      <mat-select formControlName="currency">
                        <ng-container *ngFor="let currency of currencies">
                          <mat-option [value]="currency.code">{{
                            currency.code
                          }}</mat-option>
                        </ng-container>
                      </mat-select>
                      <mat-label>Select Currency</mat-label>
                    </mat-form-field>

                    <mat-icon
                      class="float-left"
                      color="primary"
                      matTooltip="Select the currency you're using in Apple Search Ads."
                      >help</mat-icon
                    >
                  </div>
                </div>

                <!-- explainer text -->
                <div class="col-6">
                  <mat-list class="p-0 m-0 pb-2">
                    <mat-list-item class="pb-2 mb-2 border-bottom">
                      <mat-icon color="primary" class="align-text-top mr-2"
                        >done</mat-icon
                      >
                      <mat-label
                        >To create campaigns we'll need the country and app name
                      </mat-label>
                    </mat-list-item>
                    <mat-list-item class="pb-2 mb-2 border-bottom">
                      <mat-icon color="primary" class="align-text-top mr-2"
                        >done</mat-icon
                      >
                      <mat-label>
                        Hover on the help icons for more information
                      </mat-label>
                    </mat-list-item>
                  </mat-list>
                </div>
              </div>

              <!-- buttons -->
              <div class="w-100 row ml-2">
                <button
                  mat-flat-button
                  matStepperPrevious
                  class="float-left ml-2 border rounded"
                >
                  <mat-icon aria-label="back">arrow_left</mat-icon>
                  <span>back</span>
                </button>

                <button
                  mat-flat-button
                  color="primary"
                  class="float-left ml-2"
                  (click)="submitStep(1)"
                  [disabled]="substepDisabled()"
                >
                  <mat-icon class="text-light" aria-label="submit"
                    >done</mat-icon
                  >
                  <span class="text-light pl-1">next</span>
                </button>
              </div>
            </div>

            <!-- 2.2 Objective, CPI -->
            <div
              formGroupName="substep2"
              class="w-100 mt-2"
              *ngIf="isOrdinalActive(2)"
            >
              <div class="w-100 row no-gutters">
                <!-- form -->
                <div class="col-6">
                  <!-- field and icon -->
                  <div class="w-100 no-gutters">
                    <!-- objective -->
                    <mat-form-field
                      appearance="fill"
                      [hideRequiredMarker]="false"
                      class="col-10 ml-1"
                      color="primary"
                    >
                      <mat-select formControlName="objective">
                        <mat-option
                          matTooltip="Standard: &#13; Finds a balance between growth and efficiency goals and is recommended for most advertisers."
                          value="standard"
                          >Standard</mat-option
                        >
                        <mat-option
                          matTooltip="Growth: &#13; You’ll be more likely to spend your daily budget but could exceed your cost per install target."
                          value="aggressive"
                          >Growth</mat-option
                        >
                        <mat-option
                          matTooltip="Efficiency: &#13;  You’re more likely to stay within your cost per install target but you may not hit your daily budget."
                          value="conservative"
                          >Efficiency</mat-option
                        >
                      </mat-select>
                      <mat-label
                        ><mat-icon>settings</mat-icon>&nbsp;Objective</mat-label
                      >
                    </mat-form-field>

                    <mat-icon
                      class="float-left"
                      color="primary"
                      matTooltip="Objective: &#13; Determines how aggressive our system will bid to your cost per install target. &#13; &#13; We recommend allowing for 7 days of performance before changing your objective. &#13; &#13; Mouse over options for more detailed information on each strategy."
                      >help</mat-icon
                    >
                  </div>

                  <!-- field and icon -->
                  <div class="w-100 no-gutters">
                    <!--- max cpi  -->
                    <mat-form-field
                      appearance="fill"
                      class="col-10 ml-1"
                      color="primary"
                    >
                      <mat-label
                        ><mat-icon>attach_money</mat-icon>&nbsp;Target Cost Per
                        Install</mat-label
                      >
                      <input
                        matInput
                        type="number"
                        formControlName="cpi"
                        placeholder="Target Cost Per Install"
                      />
                      <mat-error>
                        Must enter a number between .1 and 1,000
                      </mat-error>
                    </mat-form-field>

                    <mat-icon
                      class="float-left"
                      color="primary"
                      matTooltip="Target Cost Per Install: &#13;  Enter the most you’re willing to spend for an install. &#13; &#13; Be realistic. Setting target too low will severely restrict your volume.  &#13; &#13; Keep changes +/- 20% of the previous value (if applicable). This prevents volatility. &#13; &#13; Also, try to allow for 7 days of performance before making adjustments."
                      >help</mat-icon
                    >
                  </div>
                </div>

                <!-- explainer text -->
                <div class="col-6">
                  <mat-list class="p-0 m-0 pb-2">
                    <mat-list-item class="pb-2 mb-2 border-bottom">
                      <mat-icon color="primary" class="align-text-top mr-2"
                        >done</mat-icon
                      >
                      <mat-label
                        >Set your objective and target cost per install
                      </mat-label>
                    </mat-list-item>
                    <mat-list-item class="pb-2 mb-2 border-bottom">
                      <mat-icon color="primary" class="align-text-top mr-2"
                        >done</mat-icon
                      >
                      <mat-label>
                        These values will determine the optimization strategy on
                        this campaign
                      </mat-label>
                    </mat-list-item>
                    <mat-list-item class="pb-2 mb-2 border-bottom">
                      <mat-icon color="primary" class="align-text-top mr-2"
                        >done</mat-icon
                      >
                      <mat-label>
                        Hover on the help icons for more information
                      </mat-label>
                    </mat-list-item>
                  </mat-list>
                </div>

                <!-- buttons -->
                <div class="w-100 row ml-2">
                  <button
                    mat-flat-button
                    (click)="goBack(2)"
                    class="float-left ml-2 border rounded"
                  >
                    <mat-icon aria-label="back">arrow_left</mat-icon>
                    <span>back</span>
                  </button>
                  <button
                    mat-flat-button
                    color="primary"
                    class="float-left ml-2"
                    (click)="submitStep(2)"
                    [disabled]="substepDisabled()"
                  >
                    <mat-icon class="text-light" aria-label="submit"
                      >done</mat-icon
                    >
                    <span class="text-light pl-1">next</span>
                  </button>
                </div>
              </div>
            </div>

            <!-- 2.3 budget -->
            <div
              formGroupName="substep3"
              class="w-100 mt-2"
              *ngIf="isOrdinalActive(3)"
            >
              <div class="w-100 row no-gutters">
                <!-- form -->
                <div class="col-6">
                  <!-- field and icon -->
                  <div class="w-100 no-gutters">
                    <!--- daily Budget -->
                    <mat-form-field
                      appearance="fill"
                      class="col-10 ml-1"
                      color="primary"
                    >
                      <mat-label
                        ><mat-icon>attach_money</mat-icon>&nbsp;Daily Budget
                        Cap</mat-label
                      >
                      <input
                        formControlName="dailyBudget"
                        matInput
                        type="number"
                        placeholder=""
                      />

                      <mat-error> {{ dailyBudgetError }} </mat-error>
                    </mat-form-field>

                    <mat-icon
                      class="float-left"
                      color="primary"
                      matTooltip="Daily Budget Cap: &#13; Enter the amount you're willing to spend per day. &#13; &#13; You know your business so you should enter what you feel is best. But if you need a guide, we suggest the following approach: &#13; # of installs you want to get per day x maximum cost per install x 10-20% buffer. Let's say you're targeting 100 installs at a $2 maximum cost per install. Your budget should be $220-$240 (100 x $2 x 120%-140%). &#13; &#13; Don't worry! You can change your daily budget cap at any time."
                      >help</mat-icon
                    >
                  </div>

                  <!-- field and icon -->
                  <div class="w-100 no-gutters">
                    <!--- Lifetime Budget -->
                    <mat-form-field
                      appearance="fill"
                      class="col-10 ml-1"
                      color="primary"
                    >
                      <mat-label
                        ><mat-icon>attach_money</mat-icon>&nbsp;Lifetime Budget
                        Cap</mat-label
                      >
                      <input
                        formControlName="lifetimeBudget"
                        matInput
                        type="number"
                        placeholder=""
                      />
                      <mat-error>
                        {{ lifetimeBudgetError }}
                      </mat-error>
                    </mat-form-field>

                    <mat-icon
                      class="float-left"
                      color="primary"
                      matTooltip="Lifetime Budget: &#13; Enter the amount you're willing to spend for the life of your Apple Search Ads campaigns. When starting, set it sufficiently high enough so it can run for a total of 30 days. This gives the system enough data and time to optimize. A simple formula, take your daily budget and multiply it by 30. So if your daily budget is $100, your lifetime budget should be $3,000. &#13; &#13; After your campaign has been running for some time you should raise your lifetime budget significantly higher. &#13; &#13; Don't worry! You can change your lifetime budget cap at any time. &#13; &#13; IMPORTANT: Your lifetime budget must be higher than your daily budget cap."
                      >help</mat-icon
                    >
                  </div>
                </div>

                <!-- explainer text -->
                <div class="col-6">
                  <mat-list class="p-0 m-0 pb-2">
                    <mat-list-item class="pb-2 mb-2 border-bottom">
                      <mat-icon color="primary" class="align-text-top mr-2"
                        >done</mat-icon
                      >
                      <mat-label
                        >Enter the lifetime and daily budget amounts for this
                        campaign
                      </mat-label>
                    </mat-list-item>
                    <mat-list-item class="pb-2 mb-2 border-bottom">
                      <mat-icon color="primary" class="align-text-top mr-2"
                        >done</mat-icon
                      >
                      <mat-label>
                        Hover on the help icons for more information
                      </mat-label>
                    </mat-list-item>
                  </mat-list>
                </div>

                <!-- buttons -->
                <div class="w-100 row ml-2">
                  <button
                    mat-flat-button
                    (click)="goBack(3)"
                    class="float-left ml-2 border rounded"
                  >
                    <mat-icon aria-label="back">arrow_left</mat-icon>
                    <span>back</span>
                  </button>
                  <button
                    mat-flat-button
                    color="primary"
                    class="float-left ml-2"
                    (click)="submitStep(3)"
                    [disabled]="substepDisabled()"
                  >
                    <mat-icon class="text-light" aria-label="submit"
                      >done</mat-icon
                    >
                    <span class="text-light pl-1">next</span>
                  </button>
                </div>
              </div>
            </div>

            <!-- 2.4 keywords, competitor category brand  -->
            <div
              formGroupName="substep4"
              class="w-100 mt-2"
              *ngIf="isOrdinalActive(4)"
            >
              <div class="w-100 row no-gutters">
                <!-- form -->
                <div class="col-6">
                  <!-- field and icon -->
                  <div class="w-100 no-gutters">
                    <mat-label class="ml-4 pl-2">
                      List your competitor's names
                      <mat-icon
                        class="font-size-14 text-muted"
                        *ngIf="keywordsCompetitors.length === 0"
                        >radio_button_unchecked</mat-icon
                      >
                      <mat-icon
                        class="font-size-14 text-muted"
                        *ngIf="keywordsCompetitors.length > 0"
                        >radio_button_checked</mat-icon
                      >
                    </mat-label>
                    <mat-form-field
                      appearance="outline"
                      class="col-9 ml-1"
                      color="primary"
                    >
                      <textarea matInput formControlName="competitors">
                      </textarea>
                    </mat-form-field>

                    <mat-icon
                      class="float-left"
                      color="primary"
                      matTooltip="Many app store searches are branded. &#13; &#13; Therefore, we recommend you bid on most, if not all, competitor terms. &#13; Try to include competitor name variants, acronyms and synonyms. &#13; &#13; You should also use top-performing keywords from your existing Apple Search Ads campaigns."
                      >help</mat-icon
                    >

                    <button
                      mat-icon-button
                      (click)="handleAddKeywords($event, 'competitors')"
                    >
                      <mat-icon class="float-right" color="primary"
                        >add_circle</mat-icon
                      >
                    </button>
                  </div>

                  <!-- chiplist -->
                  <div class="w-100 no-gutters mb-4">
                    <mat-chip-list #chipList>
                      <mat-chip
                        *ngFor="let keyword of keywordsCompetitors"
                        [selectable]="true"
                        [selected]="true"
                        [removable]="true"
                        color="primary"
                        (removed)="handleRemoveKeywords('competitors', keyword)"
                      >
                        {{ keyword }}
                        <mat-icon matChipRemove>cancel</mat-icon>
                      </mat-chip>
                    </mat-chip-list>
                  </div>

                  <mat-divider class="col-10 mb-4"></mat-divider>

                  <!-- field and icon -->
                  <div class="w-100 no-gutters">
                    <mat-label class="ml-4 pl-2">
                      List words and phrases that best describe your app and
                      business
                      <mat-icon
                        class="font-size-14 text-muted"
                        *ngIf="keywordsCategory.length === 0"
                        >radio_button_unchecked</mat-icon
                      >
                      <mat-icon
                        class="font-size-14 text-muted"
                        *ngIf="keywordsCategory.length > 0"
                        >radio_button_checked</mat-icon
                      >
                    </mat-label>

                    <mat-form-field
                      appearance="outline"
                      class="col-9 ml-1"
                      color="primary"
                    >
                      <textarea matInput formControlName="category"> </textarea>
                    </mat-form-field>

                    <mat-icon
                      class="float-left"
                      color="primary"
                      matTooltip="Try to keep the phrases between 1-4 words. &#13; &#13; Example: &#13; Say you have an automotive app. use terms like: automotive, car, automotive app, car app, etc. &#13; Do NOT include your brand name. You'll include that on the step below. &#13; &#13; You should also use top-performing keywords from your existing Apple Search Ads campaigns."
                      >help</mat-icon
                    >

                    <button
                      mat-icon-button
                      (click)="handleAddKeywords($event, 'category')"
                    >
                      <mat-icon class="float-right" color="primary"
                        >add_circle</mat-icon
                      >
                    </button>
                  </div>

                  <!-- chiplist -->
                  <div class="w-100 no-gutters mb-4">
                    <mat-chip-list>
                      <mat-chip
                        *ngFor="let keyword of keywordsCategory"
                        [selectable]="true"
                        [selected]="true"
                        [removable]="true"
                        color="primary"
                        (removed)="handleRemoveKeywords('category', keyword)"
                      >
                        {{ keyword }}
                        <mat-icon matChipRemove>cancel</mat-icon>
                      </mat-chip>
                    </mat-chip-list>
                  </div>

                  <mat-divider class="col-10 mb-4"></mat-divider>

                  <!-- field and icon -->
                  <div class="w-100 no-gutters">
                    <mat-label class="ml-4 pl-2">
                      List words and phrases that best describe your brand
                      <mat-icon
                        class="font-size-14 text-muted"
                        *ngIf="keywordsBrand.length === 0"
                        >radio_button_unchecked</mat-icon
                      >
                      <mat-icon
                        class="font-size-14 text-muted"
                        *ngIf="keywordsBrand.length > 0"
                        >radio_button_checked</mat-icon
                      >
                    </mat-label>
                    <mat-form-field
                      appearance="outline"
                      class="col-9 ml-1"
                      color="primary"
                    >
                      <textarea matInput formControlName="brand"> </textarea>
                    </mat-form-field>

                    <button
                      mat-icon-button
                      (click)="handleAddKeywords($event, 'brand')"
                    >
                      <mat-icon class="float-right" color="primary"
                        >add_circle</mat-icon
                      >
                    </button>

                    <mat-icon
                      class="float-left"
                      color="primary"
                      matTooltip="List variants of your brand name. &#13; &#13; Tip: Keep each phrase between 1-4 words. example: &#13; Let's say your brand is acme. Include phrases ike ACME, ACME App, and Download Acme App. &#13; &#13; You should also use top-performing keywords from your existing Apple Search Ads campaigns."
                      >help</mat-icon
                    >
                  </div>

                  <!-- chiplist -->
                  <div class="w-100 no-gutters mb-4">
                    <mat-chip-list>
                      <mat-chip
                        *ngFor="let keyword of keywordsBrand"
                        [selectable]="true"
                        [selected]="true"
                        [removable]="true"
                        color="primary"
                        (removed)="handleRemoveKeywords('brand', keyword)"
                      >
                        {{ keyword }}
                        <mat-icon matChipRemove>cancel</mat-icon>
                      </mat-chip>
                    </mat-chip-list>
                  </div>

                  <mat-divider class="col-10 mb-4"></mat-divider>
                </div>

                <!-- explainer text -->
                <div class="col-6">
                  <mat-list class="p-0 m-0 pb-2">
                    <mat-list-item class="pb-2 mb-2 border-bottom">
                      <mat-icon color="primary" class="align-text-top mr-2"
                        >done</mat-icon
                      >
                      <mat-label
                        >Enter terms that will be used to create exact campaigns
                      </mat-label>
                    </mat-list-item>
                    <mat-list-item class="pb-2 mb-2 border-bottom">
                      <mat-icon color="primary" class="align-text-top mr-2"
                        >done</mat-icon
                      >
                      <mat-label>
                        Hover on the help icons for more information
                      </mat-label>
                    </mat-list-item>
                  </mat-list>
                </div>

                <!-- buttons -->
                <div class="w-100 row ml-2">
                  <button
                    mat-flat-button
                    (click)="goBack(4)"
                    class="float-left ml-2 border rounded"
                  >
                    <mat-icon aria-label="back">arrow_left</mat-icon>
                    <span>back</span>
                  </button>
                  <button
                    mat-flat-button
                    color="primary"
                    class="float-left ml-2"
                    (click)="submitStep(4)"
                    [disabled]="substepDisabled()"
                  >
                    <mat-icon class="text-light" aria-label="submit"
                      >done</mat-icon
                    >
                    <span class="text-light pl-1">next</span>
                  </button>
                </div>
              </div>
            </div>

            <!-- 2.5 genders and age groups -->
            <div
              formGroupName="substep5"
              class="w-100 mt-2"
              *ngIf="isOrdinalActive(5)"
            >
              <div class="w-100 row no-gutters">
                <!-- form -->
                <div class="col-6">
                  <!-- field and icon -->
                  <div class="w-100 no-gutters">
                    <mat-form-field appearance="fill" class="col-10 ml-1">
                      <mat-select formControlName="genders" class="p-1">
                        <mat-option value="all">All (recommended)</mat-option>
                        <mat-option value="female">Female</mat-option>
                        <mat-option value="male">Male</mat-option>
                      </mat-select>
                      <mat-label
                        ><mat-icon>settings</mat-icon>&nbsp;Which genders do you
                        want to target?</mat-label
                      >
                    </mat-form-field>

                    <mat-icon
                      class="float-left"
                      color="primary"
                      matTooltip="Unless you have strict gender targeting restrictions, we recommend 'All' to maximize your reach."
                      >help</mat-icon
                    >
                  </div>

                  <!-- field and icon -->
                  <div class="w-100 no-gutters">
                    <mat-form-field appearance="fill" class="col-10 ml-1">
                      <mat-select formControlName="ages" class="p-1">
                        <mat-option value="all">All (recommended)</mat-option>
                        <mat-option value="18">18 +</mat-option>
                        <mat-option value="21">21 +</mat-option>
                      </mat-select>
                      <mat-label
                        ><mat-icon>settings</mat-icon>&nbsp;What's your app's
                        minimum age requirement?</mat-label
                      >
                    </mat-form-field>

                    <mat-icon
                      class="float-left"
                      color="primary"
                      matTooltip="Unless you have strict age targeting restrictions, we recommend 'All' to maximize your reach."
                      >help</mat-icon
                    >
                  </div>
                </div>

                <!-- explainer text -->
                <div class="col-6">
                  <mat-list class="p-0 m-0 pb-2">
                    <mat-list-item class="pb-2 mb-2 border-bottom">
                      <mat-icon color="primary" class="align-text-top mr-2"
                        >done</mat-icon
                      >
                      <mat-label
                        >Enter information to allow a specific, or a more
                        general targeting strategy
                      </mat-label>
                    </mat-list-item>
                    <mat-list-item class="pb-2 mb-2 border-bottom">
                      <mat-icon color="primary" class="align-text-top mr-2"
                        >done</mat-icon
                      >
                      <mat-label>
                        Hover on the help icons for more information
                      </mat-label>
                    </mat-list-item>
                  </mat-list>
                </div>

                <!-- buttons -->
                <div class="w-100 row ml-2">
                  <button
                    mat-flat-button
                    (click)="goBack(5)"
                    class="float-left ml-2 border rounded"
                  >
                    <mat-icon aria-label="back">arrow_left</mat-icon>
                    <span>back</span>
                  </button>
                  <button
                    mat-flat-button
                    color="primary"
                    class="float-left ml-2"
                    (click)="submitStep(5)"
                    [disabled]="substepDisabled()"
                  >
                    <mat-icon class="text-light" aria-label="submit"
                      >done</mat-icon
                    >
                    <span class="text-light pl-1">next</span>
                  </button>
                </div>
              </div>
            </div>

            <!-- 2.6 post-install/optional -->
            <div
              formGroupName="substep6"
              class="w-100 mt-2"
              *ngIf="isOrdinalActive(6)"
            >
              <div class="col-6">
                <div
                  class="mb-2"
                  matTooltip="When enabling this feature, Adoya will use your MMP data when making bid adjustments. Reach out to us via Adoya Support for more information."
                >
                  <mat-checkbox
                    formControlName="branchBidAdjusterEnabled"
                    (change)="handleBranchCheckboxChange($event)"
                  >
                    Enable Bid Optimizations For Post-Install Events (optional)
                  </mat-checkbox>
                </div>

                <!-- MMP Objective -->
                <mat-form-field
                  appearance="fill"
                  class="w-100"
                  matTooltip="MMP Objective: &#13; Use this option if you want our system to also optimize for in-app purchases. &#13; &#13; This will be a secondary objective as our system optimizes primarily for cost per install. &#13; &#13; If you have MMP enabled, we strongly recommend you select either Cost Per Purchase or Return On Ad Spend (ROAS). &#13; &#13; Mouse over options for more detailed information on each strategy."
                >
                  <mat-select formControlName="mmpObjective" class="p-1">
                    <mat-option
                      matTooltip="Cost Per Purchase: &#13;  Use this option if you’re looking to acquire/retain paying customers and less focused on the revenue amount. &#13; &#13; This option works best if you’re taking a longer-term strategy with a focus on customer lifetime value (LTV)."
                      value="cost_per_purchase"
                      >Cost Per Purchase</mat-option
                    >
                    <mat-option
                      matTooltip="Return On Ad Spend (ROAS): &#13;  Use this option if you’re looking to generate immediate revenue. &#13; &#13; ROAS is calculated by dividing revenue by cost."
                      value="revenue_over_ad_spend"
                      >Revenue/Cost</mat-option
                    >
                  </mat-select>
                  <mat-label
                    ><mat-icon>settings</mat-icon>&nbsp;MMP Optimization
                    Objective</mat-label
                  >
                </mat-form-field>

                <!-- Target Cost Per Purchase -->
                <mat-form-field appearance="fill" class="w-100">
                  <mat-label>
                    <mat-icon>attach_money</mat-icon>&nbsp;Target Cost Per
                    Purchase
                  </mat-label>
                  <input
                    class="p-1"
                    formControlName="cpp"
                    matInput
                    type="number"
                    placeholder="Target Cost Per Purchase"
                    matTooltip="Enter the most you’re willing to spend for a purchase. &#13; &#13; Be realistic. Setting a target too low will severely restrict your volume. &#13; &#13; Keep changes within +/- 20% of the previous value (if applicable). This prevents volatility. Also, try to allow for 7 days of performance before making adjustments. &#13; &#13;
                    Important: This factors in mobile measurement partner (MMP) data. &#13; &#13; Apple limits data passed through MMPs due to their privacy policies. Therefore, MMP data is often understated. &#13; &#13; Sometimes by 20% or more. Factor in that 20% when using this option. &#13; &#13; For example, if your target cost per purchase is $10, give it a 20% buffer and set the target to $12."
                  />
                  <mat-error>
                    Must enter a number between .1 and 1,000
                  </mat-error>
                </mat-form-field>

                <!-- Return on Ad spend -->
                <mat-form-field appearance="fill" class="w-100">
                  <mat-label
                    ><mat-icon>attach_money</mat-icon>&nbsp;Target Return On Ad
                    Spend</mat-label
                  >
                  <input
                    class="p-1"
                    formControlName="roas"
                    matInput
                    type="number"
                    placeholder="Target Return On Ad Spend"
                    matTooltip="Enter your target ROAS. ROAS formula = revenue / cost. &#13; &#13; Be realistic. Setting a target too high will severely restrict your volume. &#13; &#13; Keep changes within +/- 20% of the previous value (if applicable). This prevents volatility. &#13; &#13; Also, try to allow for 7 days of performance before making adjustments. &#13; &#13;
                    Important: This factors in mobile measurement partner (MMP) data. &#13; &#13; Apple limits data passed through MMPs due to their privacy policies. Therefore, MMP data is often understated. &#13; &#13; Sometimes by 20% or more. Factor in that 20% when using this option. &#13; &#13; For example, if your target ROAS is $2.00, give it a 20% discount and set it to $1.60. Formula for ROAS discount = (100% - 20%) x ROAS target."
                  />
                  <mat-error>
                    Must enter a number between .1 and 1,000
                  </mat-error>
                </mat-form-field>

                <!-- branch -->
                <mat-card-subtitle class="mt-2 mb-2">
                  Branch Integration Parameters
                </mat-card-subtitle>

                <!-- branch key -->
                <mat-form-field appearance="fill" class="w-100 mb-1">
                  <mat-label> Branch Key </mat-label>
                  <input
                    class="p-1"
                    formControlName="branchKey"
                    matInput
                    type="text"
                    placeholder=""
                  />
                </mat-form-field>

                <!-- branch secret -->
                <mat-form-field appearance="fill" class="w-100 mb-1">
                  <mat-label> Branch Secret </mat-label>
                  <input
                    class="p-1"
                    formControlName="branchSecret"
                    matInput
                    type="text"
                    placeholder=""
                  />
                </mat-form-field>

                <!-- button panel-->
                <div *ngIf="isOrdinalActive(6)">
                  <button
                    mat-flat-button
                    (click)="goBack(6)"
                    class="float-left ml-2 border rounded"
                  >
                    <mat-icon aria-label="back">arrow_left</mat-icon>
                    <span>back</span>
                  </button>
                  <button
                    mat-flat-button
                    (click)="completeStep2()"
                    color="primary"
                    class="float-left ml-2"
                    [disabled]="substepDisabled()"
                  >
                    <mat-icon class="text-light" aria-label="submit"
                      >done</mat-icon
                    >
                    <span class="text-light pl-1">next</span>
                  </button>
                </div>
              </div>
            </div>
          </ng-container>
        </form>
      </mat-step>

      <!-- TODO step to add additional countries and apps -->

      <!-- step 4 finalize -->
      <mat-step [stepControl]="step3Form">
        <form [formGroup]="step3Form">
          <ng-template matStepLabel
            >Review and complete
            <mat-icon class="pl-2" color="accent"
              >fact_check</mat-icon
            ></ng-template
          >
          <div *ngIf="isLoadingResults" class="w-100 mt-2">
            <ngx-skeleton-loader
              count="4"
              [theme]="{
                'border-radius': '0',
                height: '50px',
                width: '100%',
                'background-color': 'WhiteSmoke',
                'margin-top': '5px'
              }"
            ></ngx-skeleton-loader>
          </div>
          <div
            class="w-100"
            *ngIf="!isLoadingResults && stepper.selectedIndex > 1"
          >
            <mat-list class="p-0 m-0 pb-2">
              <mat-list-item class="mb-1 pb-2">
                <mat-icon color="primary" class="align-text-top mr-2"
                  >done</mat-icon
                >
                <mat-label>Congrats, you're all done! </mat-label>
              </mat-list-item>
              <mat-list-item class="mb-1 pb-2">
                <mat-icon color="primary" class="align-text-top mr-2"
                  >done</mat-icon
                >
                <mat-label>
                  Based on the info you've provided, we've created the following
                  campaigns and recommended budgets.
                </mat-label>
              </mat-list-item>

              <mat-list-item class="mb-1 pb-2">
                <mat-icon color="primary" class="align-text-top mr-2"
                  >build</mat-icon
                >
                <mat-label>
                  Feel free to update budgets and enable the campaigns you want
                  to run.
                </mat-label>
              </mat-list-item>
            </mat-list>
          </div>

          <div
            class="w-100 p-2 mt-2 border-top"
            *ngIf="!isLoadingResults && stepper.selectedIndex > 1"
          >
            <table class="w-100">
              <tr>
                <td class="col-2">Enable</td>
                <td class="col-8">Campaign Name</td>
                <td class="col-1">Daily Budget Cap</td>
                <td class="col-1">Lifetime Budget</td>
              </tr>
              <ng-container
                *ngFor="let campaign of client.orgDetails.appleCampaigns"
              >
                <tr>
                  <td class="col-2">
                    <mat-slide-toggle
                      color="primary"
                      [formControlName]="'status|' + campaign.campaignId"
                      >Enable</mat-slide-toggle
                    >
                  </td>
                  <td class="col-8">{{ campaign.campaignName }}</td>
                  <td class="col-1">
                    <!--- daily Budget -->
                    <mat-form-field
                      appearance="fill"
                      color="primary"
                      class="pb-2"
                    >
                      <mat-label
                        ><mat-icon>attach_money</mat-icon>&nbsp;Daily Budget
                        Cap</mat-label
                      >
                      <input
                        required
                        matInput
                        type="number"
                        placeholder=""
                        [formControlName]="'dailyBudget|' + campaign.campaignId"
                      />
                      <mat-error>
                        {{
                          step3DailyBudgetError(
                            "dailyBudget|" + campaign.campaignId
                          )
                        }}
                      </mat-error>
                    </mat-form-field>
                  </td>
                  <td class="col-1">
                    <!--- Lifetime Budget -->
                    <mat-form-field
                      appearance="fill"
                      color="primary"
                      class="pb-2"
                    >
                      <mat-label
                        ><mat-icon>attach_money</mat-icon>&nbsp;Lifetime Budget
                        Cap</mat-label
                      >
                      <input
                        required
                        matInput
                        type="number"
                        placeholder=""
                        [formControlName]="
                          'lifetimeBudget|' + campaign.campaignId
                        "
                      />
                      <mat-error>
                        {{
                          step3LifetimeBudgetError(
                            campaign.campaignType,
                            "lifetimeBudget|" + campaign.campaignId
                          )
                        }}
                      </mat-error>
                    </mat-form-field>
                  </td>
                </tr>
              </ng-container>
            </table>
          </div>
          <div *ngIf="step3Form.dirty; else continueBlock">
            <button
              mat-flat-button
              [disabled]="isLoadingResults"
              class="float-left ml-2 border rounded"
              (click)="undoStep3Changes()"
            >
              <mat-icon aria-label="undo">refresh</mat-icon>
              <span class="pl-1">undo</span>
            </button>
            <button
              mat-flat-button
              color="primary"
              class="float-left ml-2"
              [disabled]="isLoadingResults || step3Invalid()"
              (click)="updateAppleCampaign()"
            >
              <mat-icon class="text-light" aria-label="submit">done</mat-icon>
              <span class="text-light pl-1">save</span>
            </button>
          </div>
          <ng-template #continueBlock>
            <div class="w-100 mt-3 mb-3">
              <button
                mat-flat-button
                matStepperPrevious
                [disabled]="isLoadingResults || isStep3BackDisabled"
                class="float-left ml-2 border rounded"
              >
                <mat-icon aria-label="back">arrow_left</mat-icon>
                <span>back</span>
              </button>
              <button
                mat-flat-button
                color="primary"
                class="float-left ml-2"
                [disabled]="isLoadingResults"
                (click)="complete()"
              >
                <mat-icon class="text-light" aria-label="submit">done</mat-icon>
                <span class="text-light pl-1">complete</span>
              </button>
            </div>
          </ng-template>
        </form>
      </mat-step>
    </mat-vertical-stepper>
  </div>
  <app-footer (printCalled)="handlePrintTerms($event)"></app-footer>
</div>
